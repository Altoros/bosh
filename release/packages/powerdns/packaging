set -e

echo "Extracting PowerDNS archive ..."

if [ `uname -m` == "ppc64le" ] ; then
  echo "Using ppc64le 64-bit version"
  dpkg -i powerdns/pdns-static_3.3-1_ppc64el.deb
  cp -a /usr/local/sbin/pdns_server ${BOSH_INSTALL_TARGET}
elif [[ `uname -a` =~ "x86_64" ]] ; then
  echo "Using 64-bit version"
  mkdir -p target
  ar p powerdns/pdns-static_3.3.1-1_amd64.deb data.tar.gz | tar zx -C target
  cp -a target/usr/sbin/pdns_server ${BOSH_INSTALL_TARGET}
else
  echo "Unknown architecture"
  exit 2
fi

